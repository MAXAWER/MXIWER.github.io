<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MThread - Лента объявлений</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header class="site-header">
        <div class="button-container">
            <a href="https://t.me/Sureddorippaa" target="_blank" class="button">MThread Маркет</a>
            <a href="https://t.me/SureddorippaaChat" target="_blank" class="button">MThread Чат</a>
            <a href="https://t.me/SureddorippaaReviews" target="_blank" class="button">MThread Отзывы</a>
        </div>
    </header>

    <main class="feed-container">
        <h2 class="feed-title">Лента объявлений</h2>

        <div class="horizontal-feed">
            <button class="nav-button prev-button" aria-label="Предыдущее объявление">&lt;</button>

            <div class="announcements-wrapper">

                <article class="announcement-card">
                    <img src="1.png" alt="Фото Контроллер Nintendo Switch" class="announcement-photo" loading="lazy">
                    <div class="announcement-content">
                        <div class="price-buy-block">
                            <div class="location-price">
                                <p><strong>Город:</strong> Астана.</p>
                                <p class="announcement-price">Цена: 10 000 тенге</p>
                            </div>
                            <a href="https://t.me/mxiwer" target="_blank" rel="noopener noreferrer" class="buy-button">Купить</a>
                        </div>
                        <h3 class="announcement-title">Контроллер для игровой консоли Nintendo Switch</h3>
                        <p><strong>Состояние:</strong> Полностью исправен, функциональных дефектов не имеет. Подтверждена работоспособность всех кнопок и функций.</p>
                        <p><strong>Цвет:</strong> Черный.</p>
                        <p><strong>Комплект поставки:</strong> Только контроллер (без оригинальной упаковки, кабелей и дополнительных аксессуаров).</p>
                    </div>
                </article>

                <article class="announcement-card">
                    <img src="2.png" alt="Фото Motorola RAZR" class="announcement-photo" loading="lazy">
                    <div class="announcement-content">
                        <div class="price-buy-block">
                             <div class="location-price">
                                <p><strong>Город:</strong> Астана.</p>
                                <p class="announcement-price">Цена: 40 000 тенге</p>
                             </div>
                            <a href="https://t.me/mxiwer" target="_blank" rel="noopener noreferrer" class="buy-button">Купить</a>
                        </div>
                        <h3 class="announcement-title">Мобильный телефон Motorola RAZR (в форм-факторе "раскладушка")</h3>
                        <p><strong>Состояние:</strong> Полностью рабочий, основные функции исправны. На экране присутствует дефект в виде точек (визуальный недостаток, не влияющий на основную функциональность).</p>
                        <p><strong>Цвет:</strong> Черный.</p>
                        <p><strong>Комплект поставки:</strong> Только телефон (без оригинальной упаковки, зарядного устройства, кабелей и дополнительных аксессуаров).</p>
                    </div>
                </article>

                <article class="announcement-card">
                     <img src="3.png" alt="Фото Салазки для HDD Nzxt H710I" class="announcement-photo" loading="lazy">
                    <div class="announcement-content">
                        <div class="price-buy-block">
                            <div class="location-price">
                                <p><strong>Город:</strong> Астана.</p>
                                <p class="announcement-price">Цена: 5 000 тенге</p>
                            </div>
                            <a href="https://t.me/mxiwer" target="_blank" rel="noopener noreferrer" class="buy-button">Купить</a>
                        </div>
                        <h3 class="announcement-title">Салазки для HDD из корпуса Nzxt H710I</h3>
                        <p><strong>Состояние:</strong> Хорошее.</p>
                        <p><strong>Цвет:</strong> Черный.</p>
                        <p><strong>Комплект поставки:</strong> Без комплекта (только салазки).</p>
                    </div>
                </article>

                <article class="announcement-card">
                     <img src="4.png" alt="Фото Ноутбук Dell Alienware 17 R2" class="announcement-photo" loading="lazy">
                    <div class="announcement-content">
                         <div class="price-buy-block">
                             <div class="location-price">
                                <p><strong>Город:</strong> Астана.</p>
                                <p class="announcement-price">Цена: 120 000 тенге</p>
                             </div>
                            <a href="https://t.me/mxiwer" target="_blank" rel="noopener noreferrer" class="buy-button">Купить</a>
                        </div>
                        <h3 class="announcement-title">Ноутбук Dell Alienware 17 R2</h3>
                        <p><strong>Состояние:</strong> Полностью рабочий, установлен новый аккумулятор, несколько царапин на крышке (визуальный недостаток, не влияющий на основную функциональность).</p>
                        <p><strong>Цвет:</strong> Черно-серый.</p>
                        <p><strong>Комплект поставки:</strong> Зарядное устройство и коробка.</p>
                        <div class="announcement-specs">
                            <strong>Характеристики:</strong>
                            <ul>
                                <li>Процессор: Intel Core i7-4710HQ</li>
                                <li>Оперативная память: 16 ГБ DDR3</li>
                                <li>Видеокарта: NVIDIA GeForce GTX 980</li>
                                <li>Накопитель: SSD M.2 128 ГБ</li>
                            </ul>
                        </div>
                    </div>
                </article>

                <article class="announcement-card">
                    <img src="5.png" alt="Фото Alienware Graphics Amplifier (eGPU)" class="announcement-photo" loading="lazy">
                    <div class="announcement-content">
                         <div class="price-buy-block">
                             <div class="location-price">
                                <p><strong>Город:</strong> Астана.</p>
                                <p class="announcement-price">Цена: 50 000 тенге</p>
                             </div>
                            <a href="https://t.me/mxiwer" target="_blank" rel="noopener noreferrer" class="buy-button">Купить</a>
                        </div>
                        <h3 class="announcement-title">Alienware Graphics Amplifier (eGPU)</h3>
                        <p><strong>Состояние:</strong> В хорошем состоянии, полностью рабочий.</p>
                        <p><strong>Цвет:</strong> Черный.</p>
                        <p><strong>Комплект поставки:</strong> Кабель соединения с ПК, кабель питания.</p>
                        <div class="announcement-description">
                            <strong>Описание:</strong>
                            <p>Alienware Graphics Amplifier представляет собой внешнюю док-станцию для видеокарты, разработанную специально для ноутбуков Alienware. Это устройство позволяет значительно повысить графическую производительность ноутбука, подключая к нему настольную видеокарту. Amplifier оснащен собственным блоком питания, обеспечивающим необходимую мощность для работы высокопроизводительных видеокарт. Подключение к ноутбуку осуществляется через проприетарный разъем PCI-Express, обеспечивающий высокую пропускную способность для передачи данных между видеокартой и системой ноутбука. Использование Graphics Amplifier позволяет запускать на ноутбуке самые требовательные игры и приложения, требующие мощной графики, при этом сохраняя мобильность самого ноутбука при необходимости.</p> </div>
                    </div>
                </article>

                <article class="announcement-card">
                    <img src="6.png" alt="Фото iPhone 4s 8Gb" class="announcement-photo" loading="lazy">
                    <div class="announcement-content">
                         <div class="price-buy-block">
                             <div class="location-price">
                                <p><strong>Город:</strong> Астана.</p>
                                <p class="announcement-price">Цена: 6 000 тенге</p>
                             </div>
                            <a href="https://t.me/mxiwer" target="_blank" rel="noopener noreferrer" class="buy-button">Купить</a>
                        </div>
                        <h3 class="announcement-title">iPhone 4s 8Gb (без SIM-карты)</h3>
                        <p><strong>Состояние:</strong> Полностью рабочий, на крышке присутствуют царапины.</p>
                        <p><strong>Цвет:</strong> Черный.</p>
                        <p><strong>Комплект поставки:</strong> Провод для зарядки.</p>
                        <div class="announcement-extra-info">
                            <strong>Дополнительная информация:</strong>
                            <p>Данная модель iPhone 4s имеет 8 Гб встроенной памяти и не поддерживает использование SIM-карт (предназначен для использования без сотовой связи, например, для игр, просмотра видео или использования приложений через Wi-Fi).</p> </div>
                    </div>
                </article>

                <article class="announcement-card">
                    <img src="7.png" alt="Фото BlackBerry Q10" class="announcement-photo" loading="lazy">
                    <div class="announcement-content">
                         <div class="price-buy-block">
                            <div class="location-price">
                                <p><strong>Город:</strong> Астана.</p>
                                <p class="announcement-price">Цена: 10 000 тенге</p>
                            </div>
                            <a href="https://t.me/mxiwer" target="_blank" rel="noopener noreferrer" class="buy-button">Купить</a>
                        </div>
                        <h3 class="announcement-title">Мобильный телефон BlackBerry Q10</h3>
                        <p><strong>Состояние:</strong> Полностью рабочий. Активация устройства произведена, работоспособность функций, связанных с активацией (в условиях прекращения поддержки серверов BlackBerry), подтверждена. Операционная система: BlackBerry OS 10. Общее состояние оценивается как хорошее. Присутствуют царапины на поверхности экрана. Фиксация крышки аккумуляторного отсека характеризуется как неудовлетворительная.</p>
                        <p><strong>Цвет:</strong> Черный.</p>
                        <p><strong>Комплект поставки:</strong> Отсутствует.</p>
                    </div>
                </article>

                <article class="announcement-card">
                    <img src="8.png" alt="Фото Мини ПК Dell Alienware x51" class="announcement-photo" loading="lazy">
                    <div class="announcement-content">
                         <div class="price-buy-block">
                            <div class="location-price">
                                <p><strong>Город:</strong> Астана.</p>
                                <p class="announcement-price">Цена: 70 000 тенге</p>
                            </div>
                            <a href="https://t.me/mxiwer" target="_blank" rel="noopener noreferrer" class="buy-button">Купить</a>
                        </div>
                        <h3 class="announcement-title">Мини ПК Dell Alienware x51 (Компактный настольный персональный компьютер)</h3>
                        <p><strong>Состояние:</strong> Хорошее, имеются царапины на корпусе. Видеокарта отсутствует.</p>
                        <p><strong>Цвет:</strong> Черный.</p>
                        <p><strong>Комплект поставки:</strong> Блок питания мощностью 180 Вт.</p>
                        <div class="announcement-specs">
                            <strong>Характеристики:</strong>
                            <ul>
                                <li>Процессор: Intel Core i7-3770</li>
                                <li>Оперативная память: 16 ГБ DDR3</li>
                            </ul>
                        </div>
                         <div class="announcement-description">
                            <strong>Описание:</strong>
                            <p>Dell Alienware x51 представляет собой компактный игровой ПК, разработанный для обеспечения высокой производительности в условиях ограниченного пространства. Несмотря на свои скромные размеры, он способен справиться с требовательными задачами и играми благодаря мощным внутренним компонентам. Отличительной особенностью модели является стильный дизайн с настраиваемой подсветкой AlienFX, что придает системе индивидуальность. Компактность корпуса облегчает размещение ПК в различных условиях.</p> </div>
                    </div>
                </article>

                <article class="announcement-card">
                     <img src="9.png" alt="Фото Intel Optane SSD 16GB" class="announcement-photo" loading="lazy">
                    <div class="announcement-content">
                         <div class="price-buy-block">
                             <div class="location-price">
                                <p><strong>Город:</strong> Астана.</p>
                                <p class="announcement-price">Цена: 2 000 тенге <span class="stock-info">(В наличии 2шт)</span></p>
                             </div>
                            <a href="https://t.me/mxiwer" target="_blank" rel="noopener noreferrer" class="buy-button">Купить</a>
                        </div>
                        <h3 class="announcement-title">Твердотельный накопитель Intel Optane SSD 16GB</h3>
                        <p><strong>Состояние:</strong> Новый, полностью рабочий.</p>
                         <div class="announcement-description">
                            <strong>Описание:</strong>
                            <p>Твердотельный накопитель Intel Optane SSD объемом 16 ГБ представляет собой высокопроизводительное энергонезависимое устройство хранения данных, основанное на технологии Intel Optane. Данная технология характеризуется низкими задержками и высокой скоростью. Предназначен для кэширования с целью повышения производительности других накопителей.</p> </div>
                         <div class="announcement-note">
                             <strong>Примечание:</strong>
                             <p>Данный накопитель имеет ограниченный объем (16 ГБ) и, как правило, используется для ускорения работы других накопителей, а не в качестве основного устройства хранения операционной системы или большого объема данных.</p> </div>
                    </div>
                </article>

            </div> <button class="nav-button next-button" aria-label="Следующее объявление">&gt;</button>
        </div> </main>

    <script>
        const wrapper = document.querySelector('.announcements-wrapper');
        const prevButton = document.querySelector('.prev-button');
        const nextButton = document.querySelector('.next-button');
        const cards = document.querySelectorAll('.announcement-card');

        // --- Проверка найдены ли элементы ---
        // console.log('Найденные элементы:', { wrapper, prevButton, nextButton, cards });
        if (!wrapper || !prevButton || !nextButton) {
            console.error("ОШИБКА: Не найдены необходимые элементы слайдера (wrapper или кнопки). Проверьте классы в HTML.");
        }
        // --- Конец проверки ---

        let scrollAmount = 0; // Теперь будет cardWidth + gap
        let isScrolling = false;
        const scrollTimeoutDuration = 600; // Немного увеличил время ожидания
        let scrollTimeoutId = null;

        // --- Переменные для свайпа ---
        let startX = 0;
        let startY = 0;
        let distX = 0;
        let isDragging = false;
        const swipeThreshold = 50; // Минимальная дистанция свайпа в пикселях

        function calculateDimensions() {
            if (!wrapper || cards.length === 0) return;

            // --- ИСПРАВЛЕН РАСЧЕТ scrollAmount ---
            const firstCard = cards[0];
            const wrapperStyle = window.getComputedStyle(wrapper);
             // Используем || 0 на случай, если gap не задан или равен 'normal'
            const gap = parseFloat(wrapperStyle.gap) || 0;
            const cardWidth = firstCard.offsetWidth; // Реальная ширина первой карточки

            // Прокручивать нужно на ширину карточки + отступ
            scrollAmount = cardWidth + gap;
            // --- Конец исправлений ---

            // console.log('calculateDimensions - cardWidth:', cardWidth, 'gap:', gap, 'scrollAmount:', scrollAmount);
            if (scrollAmount === 0 || cardWidth === 0) {
                // Не выводим ошибку, если карточек нет, т.к. это нормально
                if (cards.length > 0) {
                  console.warn("calculateDimensions: Ширина карточки или scrollAmount равна 0. Расчеты могут быть неверны.");
                }
            }
            // Обновляем кнопки сразу после расчета
            updateButtonState();
        }

        function updateButtonState() {
            if (!wrapper || !prevButton || !nextButton) return;
            // console.log('updateButtonState - Проверка состояния. isScrolling:', isScrolling);

            const currentScroll = Math.round(wrapper.scrollLeft);
             // Добавим проверку на scrollWidth, т.к. он может быть 0 если display:none
            const maxScroll = wrapper.scrollWidth > wrapper.offsetWidth
                              ? Math.round(wrapper.scrollWidth - wrapper.offsetWidth)
                              : 0;
            // console.log('updateButtonState - currentScroll:', currentScroll, 'maxScroll:', maxScroll);

            prevButton.disabled = currentScroll <= 0 || isScrolling;
            // Сравниваем с maxScroll, учитывая возможную погрешность
            nextButton.disabled = currentScroll >= maxScroll - 5 || isScrolling; // Погрешность 5px

            // console.log('updateButtonState - Состояние кнопок:', { prev: prevButton.disabled, next: nextButton.disabled });
        }

        // Функция для выполнения скролла и установки блокировки
        function performScroll(direction) {
            if (isScrolling || !wrapper) return;
            // console.log(`performScroll - Направление: ${direction}. Текущий scrollLeft: ${wrapper.scrollLeft}`);

            const currentScroll = Math.round(wrapper.scrollLeft);
            const maxScroll = wrapper.scrollWidth > wrapper.offsetWidth
                              ? Math.round(wrapper.scrollWidth - wrapper.offsetWidth)
                              : 0;

            // Проверяем, нужно ли вообще скроллить (с погрешностью)
            if (direction === 'prev' && currentScroll <= 0) {
                // console.log("performScroll: Уже в начале.");
                return;
            }
            if (direction === 'next' && currentScroll >= maxScroll - 5) {
                 // console.log("performScroll: Уже в конце.");
                return;
            }

            isScrolling = true;
            updateButtonState();

            // Используем новый scrollAmount (cardWidth + gap)
            const targetScrollLeft = wrapper.scrollLeft + (direction === 'next' ? scrollAmount : -scrollAmount);
            // console.log(`performScroll - Целевой scrollLeft: ${targetScrollLeft}`);

            wrapper.scrollTo({
                left: targetScrollLeft,
                behavior: 'smooth'
            });

            clearTimeout(scrollTimeoutId);
            scrollTimeoutId = setTimeout(() => {
                // console.log('performScroll - Таймаут завершен. Сброс isScrolling.');
                isScrolling = false;
                // Перепроверяем позицию после скролла перед обновлением кнопок
                updateButtonState();
            }, scrollTimeoutDuration);
        }


        // --- Обработчики событий ---

        // Клик по кнопкам
        if (prevButton) {
            prevButton.addEventListener('click', () => {
                // console.log('Клик: Кнопка Назад');
                performScroll('prev');
            });
        }

        if (nextButton) {
            nextButton.addEventListener('click', () => {
                // console.log('Клик: Кнопка Вперед');
                performScroll('next');
            });
        }

        // Касания (свайп)
        if (wrapper) {
            wrapper.addEventListener('touchstart', (e) => {
                if (isScrolling) return;
                startX = e.touches[0].pageX;
                startY = e.touches[0].pageY;
                distX = 0;
                isDragging = true;
                // console.log('touchstart в точке:', startX);
            }, { passive: true });

            wrapper.addEventListener('touchmove', (e) => {
                if (!isDragging || isScrolling) return;
                if (e.touches.length === 0) return;
                const currentX = e.touches[0].pageX;
                distX = currentX - startX; // Считаем смещение от начала
                // console.log('touchmove - distX:', distX);
                 // CSS touch-action: pan-y должен предотвращать верт. скролл
            }, { passive: true });

            wrapper.addEventListener('touchend', (e) => {
                // console.log(`touchend - isDragging: ${isDragging}, isScrolling: ${isScrolling}, distX: ${distX}`);
                if (!isDragging || isScrolling) {
                     isDragging = false;
                     return;
                }
                isDragging = false;

                if (Math.abs(distX) >= swipeThreshold) { // Проверяем порог
                    // Если distX отрицательный (палец двигался влево) -> 'next'
                    // Если distX положительный (палец двигался вправо) -> 'prev'
                    performScroll(distX < 0 ? 'next' : 'prev');
                } else {
                    // console.log('touchend - Свайп слишком короткий');
                }
            });

            wrapper.addEventListener('touchcancel', () => {
                isDragging = false;
                // console.log('touchcancel');
            });
        }

        // Первоначальный расчет размеров и состояния кнопок
        window.addEventListener('load', () => {
            // console.log('Событие: window loaded');
            setTimeout(calculateDimensions, 50); // Небольшая задержка
        });
        window.addEventListener('resize', calculateDimensions); // Пересчет при изменении размера окна

        // Первоначальная проверка состояния кнопок
        setTimeout(updateButtonState, 150);

    </script>

</body>
</html>

